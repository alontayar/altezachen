<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no">
<title>אלטע זאכן — Alte Zachen</title>
<meta name="theme-color" content="#ff0000">

<!-- Preload fonts -->
<link rel="preload" href="AlteZachen-Wide.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="AlteZachen-HalfWide.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="AlteZachen-Normal.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="AlteZachen-Random.woff2" as="font" type="font/woff2" crossorigin>

<style>
/* ===== FONTS ===== */
@font-face{font-family:"AlteZachen Normal";   src:url("AlteZachen-Normal.woff2") format("woff2"),url("AlteZachen-Normal.woff") format("woff");font-display:swap}
@font-face{font-family:"AlteZachen HalfWide"; src:url("AlteZachen-HalfWide.woff2") format("woff2"),url("AlteZachen-HalfWide.woff") format("woff");font-display:swap}
@font-face{font-family:"AlteZachen Wide";     src:url("AlteZachen-Wide.woff2") format("woff2"),url("AlteZachen-Wide.woff") format("woff");font-display:swap}
@font-face{font-family:"AlteZachen Random";   src:url("AlteZachen-Random.woff2") format("woff2"),url("AlteZachen-Random.woff") format("woff");font-display:swap}

:root{
  --red:#ff0000; --black:#000; --white:#fff;

  /* Header sizing */
  --header-h: 60px;
  --icon-h-desktop: 28px;           /* גובה בסיסי לאייקונים בדסקטופ */
  --icon-h-mobile: 18px;            /* גובה בסיסי לאייקונים במובייל */

  /* Grid padding */
  --grid-pad:6vw;
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}
body{margin:0;background:#fff;color:#000;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;line-height:1.2;text-align:center}
img{display:block;max-width:100%;height:auto}

/* ================== STICKY HEADER ================== */
.site-head{
  position:fixed;top:0;left:0;right:0;z-index:1000;
  background:var(--red); border-bottom:1px solid #000;
  transform:translateY(-110%); transition:transform .35s ease;
}
.site-head.show{ transform:translateY(0) }

/* LTR פנימי לשליטה בצדדים */
.head-inner{
  direction:ltr;
  width:100%;
  display:flex;align-items:center;justify-content:space-between;
  padding:6px 8px; gap:8px;
}

/* === החלפת צדדים בדסקטופ: טסטר שמאל, לוגו ימין === */
.head-left, .head-right{ display:flex;align-items:center; flex:1 }
.head-right{ order:2; justify-content:flex-end }   /* לוגו — ימין */
.head-left { order:1; justify-content:flex-start } /* טסטר — שמאל */

/* LOGO */
.head-logo{ display:inline-flex; align-items:center; text-decoration:none }
.head-logo img{
  height:calc(var(--icon-h-desktop) * .8); /* 80% בדסקטופ */
  width:auto;
}

/* TYPE TESTER BUTTON */
.head-tt{ display:inline-flex; align-items:center; cursor:pointer; border:none; background:transparent; padding:0 }
.head-tt img{ height:var(--icon-h-desktop); width:auto }
.head-tt .tt-hover{ display:none }
.head-tt:hover .tt-default{ display:none }
.head-tt:hover .tt-hover{ display:block }

/* === מובייל: לוגו לימין, טייפטסטר לשמאל + הקטנות === */
@media (max-width:600px){
  .head-inner{ padding:6px 10px; gap:10px }

  .head-right{ order:2; justify-content:flex-end }  /* לוגו — ימין */
  .head-left { order:1; justify-content:flex-start }/* טסטר — שמאל */

  .head-tt img{ height:var(--icon-h-mobile) }
  .head-logo img{ height:calc(var(--icon-h-mobile) * .7) } /* 70% במובייל */
}

/* ========= SECTIONS ========= */
/*.section{padding:50px 16px}
.section.white{background:#fff}*/
/* מחליף את החסימה .section הקיימת */
.section{
  /* שים לב להגדלה משמעותית של ה-padding */
  padding-block: clamp(40px, 8vw, 100px);   /* למעלה/למטה */
  padding-inline: clamp(30px, 9vw, 100px);   /* ימין/שמאל */

  max-width: min(1800px, 180vw);             /* שורה קצת רחבה יותר */
  margin: 0 auto;
  background: #ffffff;
}

/* דסקטופ – עוד קצת אוויר */
@media (min-width: 1024px){
  .section{
    padding-block: clamp(72px, 10vw, 100px);
    padding-inline: clamp(32px, 8vw, 120px);
    max-width: min(1700px, 130vw);
  }
}

/* אופציונלי: להרגיש יותר “נשימה” בטקסט עצמו */
.section p{
  line-height: 1.35;     /* 1.3–1.45 עובד נהדר לטקסטים הגדולים ששמת */
  font-size: clamp(18px, 1.4vw, 24px); /* אם רוצים להגדיל מעט */
}








.wrap{max-width:1420px;margin:0 auto}

/* HERO (אדום + תמונה לגלילה) */
#hero.hero-landing{background:#ff0000;padding:0;margin:0;width:100vw}
#hero.hero-landing .hero-media{
  display:block;margin:0 auto;
  width:min(92vw,1600px);max-width:92vw;height:auto;object-fit:contain;
}
@media (max-width:767px){
  #hero.hero-landing .hero-media{width:100vw;max-width:100vw;height:auto}
}



/* HERO (אדום + תמונה לגלילה) */
#hero.hero-landingg{background:#ffffff;padding:0;margin:0;width:100vw}
#hero.hero-landingg .hero-media{
  display:block;margin:0 auto;
  width:min(92vw,1600px);max-width:92vw;height:auto;object-fit:contain;
}
@media (max-width:767px){
  #hero.hero-landingg .hero-media{width:100vw;max-width:100vw;height:auto}
}




/* specimen blocks */
.huge{font-size:12vw;line-height:.7;margin:0}
.big {font-size:9vw; line-height:.7;  margin:.06em 0}
.mid {font-size:6vw; line-height:.96; margin:.1em 0}
@media (min-width:1200px){.huge{font-size:160px}.big{font-size:300px}.mid{font-size:120px}}
.weight{font-size:24px;font-weight:700;margin-bottom:8px}
@media (max-width:600px){.weight{font-size:14px;margin-bottom:4px}}



.weightt{
  font-size:24px;
  font-weight:700;
  margin-bottom:8px;
  color:#fff;
}
@media (max-width:600px){
  .weightt{
    font-size:14px;
    margin-bottom:4px;
    color:#fff; /* optional here; inherits from above */
  }
}




.section.spec{padding-top:56px;padding-bottom:56px}

/* ===== GLYPH GRID (גרסה הנקייה) ===== */
.glyphs-shell{padding-left:var(--grid-pad);padding-right:var(--grid-pad)}
.glyphs-wrap{display:flex;gap:16px;align-items:flex-start;direction:ltr}
.preview-col{flex:0 0 38%;max-width:700px;min-width:300px;position:sticky;top:16px}
.grid-col{flex:1 1 auto;min-width:320px}
.cell.filler{background:#fff}.cell.filler .glyph{display:none}

.preview-box{width:100%;height:0;padding-bottom:100%;border:1px solid #000;background:#fff;position:relative;overflow:hidden}
.preview-glyph{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#ff0000;font-family:"AlteZachen Normal","AlteZachen Wide";line-height:1;text-align:center;font-size:30vw;max-font-size:600px;transform:translateY(-16%)}
@media (min-width:1400px){.preview-glyph{font-size:600px}}
.preview-meta{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font:13px/1.2 Arial,Helvetica,sans-serif;color:#000}

.tabs{display:flex;flex-direction:row-reverse;border:1px solid #000;margin-top:8px}
.tab{flex:1 1 33%;appearance:none;border:0;margin:0;padding:.7em 1.1em;background:#fff;color:#000;cursor:pointer;font-weight:700;font-size:18px;border-left:1px solid #000}
.tab:last-child{border-left:0}.tab.active{background:#000;color:#fff}
@media (min-width:1024px){.tab{font-size:20px}}

.cat{margin-bottom:24px}
.grid{--cell:var(--cellPx);display:inline-grid;grid-template-columns:repeat(var(--cols),var(--cell));grid-auto-rows:var(--cell);gap:1px;background:#000;padding:1px}
.cell{width:var(--cell);height:var(--cell);background:#fff;display:flex;align-items:center;justify-content:center;user-select:none;-webkit-user-select:none}
.glyph{color:#000;line-height:1;transform:translateY(-6%);font-family:"AlteZachen Normal";font-size:calc(var(--cell)*.62);transition:color .08s ease,background-color .08s ease}
@media (hover:hover){.cell:hover .glyph{color:#fff}.cell:hover{background:#000}}
.sepLine{height:16px}

@media (max-width:600px){
  .cat{margin-bottom:12px}.sepLine{height:10px}
  .glyphs-wrap{display:block}.preview-col{display:none!important}.grid-col{width:100%;max-width:none}
  :root{--grid-pad:4vw}
}

/* Mobile tap preview */
.touch-preview{position:fixed;left:0;top:0;width:0;height:0;display:none;border:1px solid #000;background:#fff;z-index:70;align-items:center;justify-content:center;touch-action:manipulation}
.tp-glyph{color:#000;font-family:"AlteZachen Normal";line-height:1;transform:translateY(-16%)}

/* Red takeover */
.about-stage{height:200vh}
.about-stick{position:sticky;top:0;height:100vh;background:#ff0000;color:#fff;display:flex;align-items:center;justify-content:center;padding:8vw 6vw}
.about-content{max-width:1200px;margin:0 auto;font-family:"AlteZachen Normal","AlteZachen Wide";font-size:7vw;line-height:1.12}
@media (min-width:1200px){.about-content{font-size:72px}}

/* ===== TYPE TESTER ===== */
.tester{position:fixed;inset:0;background:#000;color:#fff;z-index:1200;display:none;overflow:auto}
.tester.open{display:block}

/* Desktop toolbar: GRID — Close | Weights | Buy */
.tester-bar{position:sticky;top:0;background:#000;padding:10px 12px;z-index:1210}
.tbar-grid{
  display:grid; grid-template-columns:auto 1fr auto;
  align-items:center; gap:12px;
}
.tbar-close{ justify-self:start }
.tbar-weights{ justify-self:center }
.tbar-buy{ justify-self:end }

/* desktop weight buttons */
.tweights{display:flex;gap:10px;flex-wrap:nowrap}
.tweights .tbtn{appearance:none;cursor:pointer;font-weight:700;padding:.58em 1.1em;border:1px solid #ff0000;background:#ff0000;color:#fff;font-family:"AlteZachen Normal";font-size:18px;white-space:nowrap}
.tweights .tbtn:hover{background:#fff;color:#000;border-color:#fff}

/* mobile weights – inline row (HalfWide + big + active red) */
.m-weights{display:none}
@media (max-width:600px){
  .tweights{display:none}
  .m-weights{
    display:flex;gap:10px;justify-content:center;align-items:center;
    font-family:"AlteZachen HalfWide"; font-size:22px; line-height:1;
    padding:2px 0;
  }
  .m-weights button{background:none;border:0;color:#fff;cursor:pointer;padding:0}
  .m-weights button.active{color:#ff0000}
  .m-weights .sep{opacity:.6}
}

/* purchase/close buttons */
.tbtn{appearance:none;cursor:pointer;font-weight:700;padding:.58em 1.1em;border:1px solid #ff0000;background:#ff0000;color:#fff;font-family:"AlteZachen Normal";font-size:18px}
.tbtn:hover{background:#fff;color:#000;border-color:#fff}

/* desktop top actions always visible */
.buy-top,.close-top{display:inline-flex}

/* === TYPE TESTER – כרטיס אפור, לשוניות ממורכזות, חלון טקסט === */
.tester-section{ display:flex; justify-content:center; }

.tester{
  width: min(98vw, 1600px);
  margin-inline:auto;
  background:#e9edf2;               /* אפור עדין */
  border-radius:16px;
  padding: clamp(10px, 1.6vw, 16px);
  display:flex; flex-direction:column; gap:var(--gap, 8px);
  box-sizing:border-box;
}

.weights{
  display:flex; justify-content:center; align-items:center; gap:10px; flex-wrap:wrap;
}
.weight-btn{
  font-family:"AlteZachen-HalfWide", system-ui, sans-serif;
  font-size: clamp(12px,1.2vw,16px);
  line-height:1; padding:9px 12px;
  border:1px solid #000; border-radius:8px;
  background:#fff; color:#000; cursor:pointer; user-select:none;
}
.weight-btn.active{ background:#ff0000; color:#fff; border-color:#ff0000; }

.window{
  width:100%; border-radius:12px; overflow:hidden;
  display:flex; align-items:center; justify-content:center;
  transition:height .16s ease;     /* גובה “נושם” קלות מלמטה בלבד */
}

.text{
  --f: 180px;
  font-size: var(--f);
  line-height:1;
  font-kerning:normal;
  font-feature-settings:"kern" 1, "liga" 1;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;

  font-family:"AlteZachen-Random", system-ui, sans-serif;
  color:#000; background:transparent;

  outline:none; border:none; caret-color:#000;
  white-space:nowrap; text-align:center; direction:rtl;

  display:block; max-width:100%;
  padding-inline: clamp(4px, 1vw, 8px);
  padding-bottom: 10px;           /* שמירה לדסנדרים */
  transform: translateY(-2%);     /* הרמה אופטית קלה */
}

/* מובייל */
@media (max-width:700px){
  .tester{width:calc(100vw - 12px)}
  .weight-btn{font-size: clamp(12px,3.8vw,15px); padding:8px 10px}
}




/* ——— לינקים ככפתורים (ללא קו תחתון) ——— */
a.tbtn{
  text-decoration:none;
}
a.tbtn:hover,
a.tbtn:focus,
a.tbtn:active{
  text-decoration:none;
}
</style>
</head>
<body>

<!-- ================== HEADER ================== -->
<header class="site-head" id="siteHead" aria-label="ראש האתר">
  <div class="head-inner">
    <!-- שמאל (בדסקטופ): טסטר | ימין: לוגו. במובייל אותו סדר (טסטר שמאל, לוגו ימין) -->
    <div class="head-right">
      <a class="head-logo" href="https://hafontia.com" target="_blank" rel="noopener" aria-label="הפונטיה">
        <img src="logoheader.webp" alt="hafontia">
      </a>
    </div>
  </div>
</header>

<!-- ================== HERO IMAGE ================== -->
<section id="hero" class="hero-landing">
  <img src="hero.webp" class="hero-media" alt="">
</section>


<section class="tester-section">
  <div class="tester" id="tester" data-default-font="AlteZachen-Random" aria-label="טייפ־טסטר">
    <div class="weights" role="tablist" aria-label="משקלים">
      <button class="weight-btn" role="tab" aria-selected="false" data-font="AlteZachen-Normal">נורמל</button>
      <button class="weight-btn" role="tab" aria-selected="false" data-font="AlteZachen-HalfWide">חצי־רחב</button>
      <button class="weight-btn" role="tab" aria-selected="false" data-font="AlteZachen-Wide">רחב</button>
      <button class="weight-btn active" role="tab" aria-selected="true"  data-font="AlteZachen-Random">רנדום</button>
    </div>

    <div class="window" id="win">
      <div id="txt" class="text" contenteditable="true" spellcheck="false" aria-label="עריכת טקסט">אלטע זאכן</div>
    </div>
  </div>
</section>


<!-- ================== HERO2 IMAGE ================== -->
<section id="hero" class="hero-landingg">
  <img src="hero2.webp" class="hero-media" alt="">
</section>





<!-- ================== HERO3 IMAGE ================== -->
<section id="hero" class="hero-landingg">
    <div class="weight" style="font-family:'AlteZachen Normal'">פיצ׳רים</div>
  <img src="hero3.webp" class="hero-media" alt="">
</section>




<!-- ================== GLYPH GRID ================== -->
<section class="section white glyphs-shell" id="glyphs">
  <div class="glyphs-wrap">
    <div class="preview-col">
      <div class="preview-box"><div id="bigGlyph" class="preview-glyph" aria-live="polite">א</div></div>
      <div class="preview-meta"><span id="glyphName">HEBREW LETTER ALEF</span><span id="glyphCode">U+05D0</span></div>
      <div class="tabs" role="tablist" aria-label="Weights">
        <button class="tab"        data-face="AlteZachen Wide"     style="font-family:'AlteZachen Wide'">רחב</button>
        <button class="tab"        data-face="AlteZachen HalfWide" style="font-family:'AlteZachen HalfWide'">חצי־רחב</button>
        <button class="tab active" data-face="AlteZachen Normal"   style="font-family:'AlteZachen Normal'">נורמל</button>
      </div>
    </div>
    <div class="grid-col" id="gridCol">
      <div id="cats"></div>
    </div>
  </div>
</section>

<!-- takeover -->
<!-- <section class="about-stage" id="about">
  <div class="about-stick">
    <div class="about-content">
      אלטע זאכן הוא פונט עברי בהשראת לטרינג וכרזות מודפסות משנות ה־30 וה־40... שלושה משקלים — נורמל, חצי־רחב, רחב — ולצידם “רנדום”.
    </div>
  </div>
</section> -->

<section id="hero" class="hero-landing">
  <br><br>
  <img src="hero4.webp" class="hero-media" alt="">
   <div class="weightt" style="font-family:'AlteZachen Random'">HAFONTIA/ALON TAYAR (2025)©</div>
   <br><br>
</section>

<!-- ================== TYPE TESTER ================== -->

<div class="tester" id="tester" aria-hidden="true">
  <div class="tester-bar">
    <div class="tbar-grid">
      <!-- היה כאן close; עכשיו רכישה מצד שמאל/תחילת השורה -->
      <div class="tbar-close">
        <a class="tbtn buy-top" id="buyInside" href="https://hafontia.com/family/altezachen/" target="_blank" rel="noopener">רכישה</a>
      </div>

      <div class="tbar-weights">
        <!-- desktop weight buttons -->
        <div class="tweights" id="testerWeights">
          <button class="tbtn" data-face="AlteZachen Normal">נורמל</button>
          <button class="tbtn" data-face="AlteZachen HalfWide">חצי־רחב</button>
          <button class="tbtn" data-face="AlteZachen Wide">רחב</button>
          <button class="tbtn active" data-face="AlteZachen Random">רנדום</button>
        </div>
        <!-- mobile weight row -->
        <div class="m-weights" id="mWeights">
          <button data-face="AlteZachen Normal">נורמל</button>
          <span class="sep">|</span>
          <button data-face="AlteZachen HalfWide">חצי־רחב</button>
          <span class="sep">|</span>
          <button data-face="AlteZachen Wide">רחב</button>
          <span class="sep">|</span>
          <button data-face="AlteZachen Random" class="active">רנדום</button>
        </div>
      </div>

      <!-- היה כאן buy; עכשיו סגירה מצד ימין/סוף השורה -->
      <div class="tbar-buy">
        <button class="tbtn close-top" id="closeTester">סגירה</button>
      </div>
    </div>
  </div>

  <div id="testerText" class="tester-text" contenteditable="true" spellcheck="false">סברינה קרפנטר המלכה!!!1</div>

  <div class="tester-foot">
    <!-- החלפת סדר הכפתורים גם בפוטר -->
    <button class="tbtn" id="closeMobile">סגירה</button>
    <a class="tbtn" id="buyMobile" href="https://hafontia.com/family/altezachen/" target="_blank" rel="noopener">רכישה</a>
  </div>
</div>






<!-- tap preview for mobile grid -->
<div class="touch-preview" id="touchPreview" aria-hidden="true"><div class="tp-glyph" id="tpGlyph">א</div></div>

<script>
/* ===== Header reveal only after hero red ends ===== */
(()=>{const head=document.getElementById('siteHead'), hero=document.getElementById('hero');
function sync(){const cut=hero?hero.offsetTop+hero.offsetHeight-1:0; if(pageYOffset>cut) head.classList.add('show'); else head.classList.remove('show');}
addEventListener('scroll',sync,{passive:true}); addEventListener('resize',sync); document.addEventListener('DOMContentLoaded',sync);})();

/* ===== GLYPH DATA (4 קטגוריות) ===== */
const HEB1="אבגדהוזחטיכךלמםנןסעפףצץקרשת";
const HEB2="אַ אָ אּ בּ גּ דּ הּ וּ וֹ זּ טּ יּ ךּ כּ לּ מּ נּ סּ ףּ פּ צּ קּ רּ שּ שׁ שׂ שּׁ שּׂ תּ";
const LAT1="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const LAT2="Á Ă Â Ä À Ā Å Ã Æ Ć Ç Č Ď Đ É Ě Ê Ë È Ē Ė Ə Ğ Ġ Ģ Ĥ";
const LAT3="Í Ĭ Î Ï Ì İ Į Ĵ Ķ Ĺ Ľ Ł Ń Ň Ñ Ó Ô Ö Ò Ō Õ Œ Þ Ŕ Ř Ŗ Ś Ş Ș ß Ť Ţ Ú Û Ü Ù Ū Ů Ű Ų Ŵ Ŷ Ÿ Ý Ź Ž Ż Ǐ Ĺ Ń";
const CYR="А Б В Г Д Е Ё Ж З И Й К Л М Н О П Р С Т У Ф Х Ц Ч Ш Щ Ъ Ы Ь Э Ю Я Є Ї І Ґ";
const NUM="0 1 2 3 4 5 6 7 8 9";
const FRAC="½ ¼ ¾ ⅜ ⅝ ⅞";
const CURR="¢ ¤ $ € ₽ ₪ £ ¥";
const PUNC=". , ; : … ! ? ¿ • * # / \\ – — ― _ ( ) { } [ ] „ “ ” « » ‹ › ‚ ‘ ’";
const MISC="☺ ☹ @ & ¶ © ® ℗ ™ ° | ¦";
const GEOM="█ □ ▲ ▶ ▼ ◀ △ ○ ●";
const ARROWS="↻ ↓ ↑ → ← ↗ ↖ ↘ ↙ ⤓ ⤒ ↔ ↕ ↤ ↥ ↦ ↧ ↰ ↱ ↲ ↳";
const MATH="− × ÷ = ≠ > < ≥ ≤ ± ≈ ~ ¬ ∅ % ‰";

const CATS=[
  { label:"Hebrew",  chunks:[HEB1, HEB2] },
  { label:"Latin",   chunks:[LAT1, LAT2, LAT3] },
  { label:"Cyrillic",chunks:[CYR] },
  { label:"Everything", chunks:[
      NUM,
      { text:NUM, feat:'"onum" 1', variant:'oldstyle-nums' },
      { text:NUM, feat:'"ss03" 1' },
      { text:NUM, feat:'"ss04" 1' },
      FRAC, CURR, PUNC, MISC, GEOM, ARROWS, MATH
  ] }
];

/* ===== GRID BUILD ===== */
let currentFace="AlteZachen Normal";
const catsHolder=document.getElementById('cats'), gridCol=document.getElementById('gridCol');
const bigGlyph=document.getElementById('bigGlyph'), glyphName=document.getElementById('glyphName'), glyphCode=document.getElementById('glyphCode');

function isMobile(){ return matchMedia('(max-width:600px)').matches; }
function colsPerRow(){ return isMobile()?10:15; }
function measureCell(){
  const cols=colsPerRow();
  const w=gridCol.clientWidth||innerWidth;
  const borders=(cols+1)*1+2;
  const px=Math.floor((w-borders)/cols);
  document.documentElement.style.setProperty('--cellPx',px+'px');
  return px;
}
function eachChar(str,cb){ for(let i=0;i<str.length;i++){ const ch=str[i]; if(ch===" "||ch==="\n"||ch==="\t") continue; cb(ch);} }
function cellEl(ch,feat,variant){
  const cell=document.createElement('div'); cell.className='cell';
  const s=document.createElement('span'); s.className='glyph';
  s.style.fontFamily='"'+currentFace+'",system-ui';
  if(feat) s.style.fontFeatureSettings=feat;
  if(variant==='oldstyle-nums') s.style.fontVariantNumeric='oldstyle-nums';
  s.textContent=ch; cell.appendChild(s);
  cell.addEventListener('mouseenter',()=>{ if(!isMobile()) showGlyph(ch,feat); });
  cell.addEventListener('click',()=> onCellTap(cell,ch,feat));
  return cell;
}
function buildCats(){
  catsHolder.innerHTML="";
  const cols=colsPerRow(); measureCell();
  CATS.forEach((cat,ci)=>{
    const wrap=document.createElement('div'); wrap.className='cat';
    const grid=document.createElement('div'); grid.className='grid';
    grid.style.setProperty('--cols',cols);
    cat.chunks.forEach(chk=>{
      const text=typeof chk==="object"?chk.text:chk;
      const feat=typeof chk==="object"?chk.feat:"";
      const variant=typeof chk==="object"?chk.variant:"";
      eachChar(text,(ch)=> grid.appendChild( cellEl(ch,feat,variant) ));
    });
    const total=grid.children.length, rem= total % cols;
    if(rem!==0){ for(let k=0;k<(cols-rem);k++){ const f=document.createElement('div'); f.className='cell filler'; grid.appendChild(f); } }
    wrap.appendChild(grid); catsHolder.appendChild(wrap);
    if(ci<CATS.length-1){ const sep=document.createElement('div'); sep.className='sepLine'; catsHolder.appendChild(sep); }
  });
  showGlyph('א');
}
function rebuildFaces(){
  document.querySelectorAll('.glyph').forEach(el=>{ el.style.fontFamily='"'+currentFace+'",system-ui'; });
  const fs=bigGlyph.style.fontFeatureSettings||"normal";
  bigGlyph.style.fontFamily='"'+currentFace+'","AlteZachen Wide",system-ui';
  bigGlyph.style.fontFeatureSettings=fs;
}

/* big preview */
function showGlyph(ch,feat){
  if(bigGlyph){
    bigGlyph.textContent=ch;
    bigGlyph.style.fontFamily='"'+currentFace+'","AlteZachen Wide",system-ui';
    bigGlyph.style.fontFeatureSettings=feat||"normal";
  }
  glyphName.textContent=nameOf(ch);
  glyphCode.textContent=codeOf(ch);
}
const HEB_NAMES={"א":"HEBREW LETTER ALEF","ב":"HEBREW LETTER BET","ג":"HEBREW LETTER GIMEL","ד":"HEBREW LETTER DALET","ה":"HEBREW LETTER HE","ו":"HEBREW LETTER VAV","ז":"HEBREW LETTER ZAYIN","ח":"HEBREW LETTER HET","ט":"HEBREW LETTER TET","י":"HEBREW LETTER YOD","כ":"HEBREW LETTER KAF","ך":"HEBREW LETTER FINAL KAF","ל":"HEBREW LETTER LAMED","מ":"HEBREW LETTER MEM","ם":"HEBREW LETTER FINAL MEM","נ":"HEBREW LETTER NUN","ן":"HEBREW LETTER FINAL NUN","ס":"HEBREW LETTER SAMEKH","ע":"HEBREW LETTER AYIN","פ":"HEBREW LETTER PE","ף":"HEBREW LETTER FINAL PE","צ":"HEBREW LETTER TSADI","ץ":"HEBREW LETTER FINAL TSADI","ק":"HEBREW LETTER QOF","ר":"HEBREW LETTER RESH","ש":"HEBREW LETTER SHIN","ת":"HEBREW LETTER TAV"};
function nameOf(ch){ if(HEB_NAMES[ch])return HEB_NAMES[ch]; const cp=ch.codePointAt(0); if(ch>='A'&&ch<='Z')return"LATIN CAPITAL LETTER "+ch; if(ch>='0'&&ch<='9')return"DIGIT "+ch; let h=cp.toString(16).toUpperCase(); while(h.length<4)h="0"+h; return"U+"+h }
function codeOf(ch){ let h=ch.codePointAt(0).toString(16).toUpperCase(); while(h.length<4)h="0"+h; return"U+"+h }

/* Mobile tap preview */
const overlay=document.getElementById('touchPreview'), tpGlyph=document.getElementById('tpGlyph');
function hideOverlay(){ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); }
function onCellTap(cell,ch,feat){
  if(!isMobile()) return;
  const r=cell.getBoundingClientRect();
  const size=Math.min(innerWidth*0.9, r.width*3.6);
  let left=r.left+r.width/2-size/2, top=r.top+r.height/2-size/2;
  left=Math.max(6,Math.min(left,innerWidth-size-6));
  top =Math.max(6,Math.min(top ,innerHeight-size-6));
  overlay.style.cssText='display:flex;left:'+left+'px;top:'+top+'px;width:'+size+'px;height:'+size+'px';
  tpGlyph.textContent=ch; tpGlyph.style.fontFamily='"'+currentFace+'",system-ui'; tpGlyph.style.fontFeatureSettings=feat||'normal'; tpGlyph.style.fontSize=(size*0.76)+'px';
  overlay.setAttribute('aria-hidden','false');
}
overlay.addEventListener('click',hideOverlay);
addEventListener('scroll',()=>{ if(isMobile()) hideOverlay(); },{passive:true});

/* tabs */
document.querySelectorAll('.tabs .tab').forEach(t=>{
  t.addEventListener('click',function(){
    document.querySelectorAll('.tabs .tab').forEach(x=>x.classList.remove('active'));
    this.classList.add('active'); currentFace=this.dataset.face; rebuildFaces();
  });
});

/* ===== TYPE TESTER ===== */
<script>
(function(){
  const BASE_TEXT = 'אלטע זאכן'; // זה הגודל המקסימלי לפי המסך
  const tester  = document.getElementById('tester');
  if(!tester) return;

  const txtNode = document.getElementById('txt');
  const winNode = document.getElementById('win');
  const tabs    = Array.from(tester.querySelectorAll('.weight-btn'));
  const mqMobile= window.matchMedia('(max-width:700px)');
  const defFont = tester.getAttribute('data-default-font') || 'AlteZachen-Random';

  const FONT_MAX_DESKTOP = 1500;   // תקרות בטיחות
  const FONT_MAX_MOBILE  = 520;

  let baselineSize = null;         // הגודל של “אלטע זאכן” למסך/משקל נוכחי

  // מודד נסתר
  const meas = document.createElement('span');
  Object.assign(meas.style, {
    position:'absolute', visibility:'hidden', pointerEvents:'none',
    whiteSpace:'nowrap', lineHeight:'1'
  });
  document.body.appendChild(meas);

  function availW(){
    const cs = getComputedStyle(txtNode);
    const padX = parseFloat(cs.paddingInlineStart) + parseFloat(cs.paddingInlineEnd);
    return Math.max(10, winNode.clientWidth - padX - 2);
  }
  function availH(){
    return Math.max(10, winNode.clientHeight - 8);
  }

  function fitSize(text, w, h){
    const cs = getComputedStyle(txtNode);
    meas.style.fontFamily    = cs.fontFamily;
    meas.style.letterSpacing = cs.letterSpacing;
    meas.textContent         = (text || '').trim() || BASE_TEXT;

    const FONT_MAX = mqMobile.matches ? FONT_MAX_MOBILE : FONT_MAX_DESKTOP;
    let lo=8, hi=FONT_MAX, best=16;
    while(lo<=hi){
      const mid = Math.floor((lo+hi)/2);
      meas.style.fontSize = mid + 'px';
      const r = meas.getBoundingClientRect();
      const fits = (r.width <= w) && (r.height * 1.06 <= h); // guard גובה
      if (fits){ best = mid; lo = mid+1; } else { hi = mid-1; }
    }
    return best;
  }

  function setWindowHeight(){
    const t = (txtNode.textContent || '').trim() || BASE_TEXT;
    const len = [...t].length;
    const isMobile = mqMobile.matches;
    const minVh = isMobile ? 20 : 16;
    const maxVh = isMobile ? 32 : 26;
    const shrink = Math.min(12, Math.max(0, (len - 9) * 0.5));
    let vh = maxVh - shrink;
    if (vh < minVh) vh = minVh;
    winNode.style.height = vh + 'vh';
  }

  function render(){
    setWindowHeight();
    const t = (txtNode.textContent || '').trim() || BASE_TEXT;
    const len = [...t].length;

    // גודל שמתאים לרוחב/גובה הנוכחי:
    const sizeForText = fitSize(t, availW(), availH());

    // לא לעבור את המקסימום של “אלטע זאכן” (Baselined לתנאי המסך/משקל)
    const final = Math.min(sizeForText, baselineSize || sizeForText);
    txtNode.style.setProperty('--f', final + 'px');

    // הפחתת הרווח בין לשוניות לטקסט כשקצר:
    tester.style.setProperty('--gap', (len <= 9 ? 4 : 8) + 'px');
  }

  function setFamily(ff){
    txtNode.style.fontFamily = `"${ff}", system-ui, sans-serif`;
    // baseline לפי גובה ורוחב החלון הנוכחיים
    setWindowHeight();
    baselineSize = fitSize(BASE_TEXT, availW(), availH());
    render();
  }

  // לשוניות
  tabs.forEach(b=>{
    if (b.dataset.font === defFont) { b.classList.add('active'); b.setAttribute('aria-selected','true'); }
    b.addEventListener('click', ()=>{
      tabs.forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false');});
      b.classList.add('active'); b.setAttribute('aria-selected','true');
      setFamily(b.dataset.font);
    });
  });

  // INIT
  setFamily(defFont);
  window.addEventListener('resize', ()=>{ setWindowHeight(); baselineSize = fitSize(BASE_TEXT, availW(), availH()); render(); }, {passive:true});
  txtNode.addEventListener('input', render);
  txtNode.addEventListener('focus', ()=> txtNode.style.outline='none');
})();



/* ===== Build glyph grid ===== */
function colsPerRow(){ return matchMedia('(max-width:600px)').matches?10:15; }
function measureCell(){
  const cols=colsPerRow(); const w=gridCol.clientWidth||innerWidth;
  const px=Math.floor((w-(cols+1)*1-2)/cols); document.documentElement.style.setProperty('--cellPx',px+'px'); return px;
}
addEventListener('resize',()=>{ measureCell(); buildCats(); });
document.addEventListener('DOMContentLoaded',()=>{ measureCell(); buildCats(); });

/* helpers */
function nameOf(ch){ if(HEB_NAMES[ch])return HEB_NAMES[ch]; const cp=ch.codePointAt(0); if(ch>='A'&&ch<='Z')return"LATIN CAPITAL LETTER "+ch; if(ch>='0'&&ch<='9')return"DIGIT "+ch; let h=cp.toString(16).toUpperCase(); while(h.length<4)h="0"+h; return"U+"+h }
function codeOf(ch){ let h=ch.codePointAt(0).toString(16).toUpperCase(); while(h.length<4)h="0"+h; return"U+"+h }
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>אלטע זאכן — Specimen</title>

<!-- ===== FONTS (no folders; keep in repo root) ===== -->
<style>
@font-face{
  font-family:"AlteZachen-Normal";
  src:url("AlteZachen-Normal.woff2") format("woff2"),
      url("AlteZachen-Normal.woff") format("woff"),
      url("AlteZachen-Normal.otf") format("opentype");
  font-display:swap;
}
@font-face{
  font-family:"AlteZachen-HalfWide";
  src:url("AlteZachen-HalfWide.woff2") format("woff2"),
      url("AlteZachen-HalfWide.woff") format("woff"),
      url("AlteZachen-HalfWide.otf") format("opentype");
  font-display:swap;
}
@font-face{
  font-family:"AlteZachen-Wide";
  src:url("AlteZachen-Wide.woff2") format("woff2"),
      url("AlteZachen-Wide.woff") format("woff"),
      url("AlteZachen-Wide.otf") format("opentype");
  font-display:swap;
}
@font-face{
  font-family:"AlteZachen-Random";
  src:url("AlteZachen-Random.woff2") format("woff2"),
      url("AlteZachen-Random.woff") format("woff"),
      url("AlteZachen-Random.otf") format("opentype");
  font-display:swap;
}

/* ===== Base ===== */
:root{
  --red:#ff0000;
  --grey:#e9edf2;           /* אפור מעט כהה יותר (חלון) */
}
html,body{margin:0;background:#fff;color:#000; overflow-x:hidden;}
body{font-family:"AlteZachen-Normal", system-ui, -apple-system, "Segoe UI", Arial, sans-serif}

/* ===== Sticky header (פשוט לדוגמה) ===== */
.site-header{
  position:sticky; top:-1px; z-index:50;
  background:var(--red); border-bottom:1px solid #000;
  padding:8px 10px; display:flex; align-items:center; justify-content:flex-end;
}
.site-header .logo-link{display:inline-flex; align-items:center}
.site-header img{height:28px; width:auto; display:block}

/* ===== HERO אדום (תמונה) ===== */
.hero-red{background:var(--red)}
.hero-wrap{
  max-width:min(92vw, 1400px);
  margin-inline:auto;
  padding-block:min(6vh,80px) min(8vh,120px);
}
.hero-img{
  display:block; margin:0 auto;
  width:min(88vw, 1400px); height:auto; object-fit:contain;
}

/* ===== MAIN ===== */
.white{background:#fff; padding:min(6vh,80px) clamp(12px,4vw,40px)}

/* ===== TYPE TESTER – חלון קבוע ברוחב, גובה זורם קטן ===== */
.tester-section{ display:flex; justify-content:center; }

.tester{
  /* רוחב קבוע יחסית למסך – לא משתנה עם התוכן */
  width: min(98vw, 1600px);
  margin-inline:auto;

  background:var(--grey);
  border-radius:16px;
  padding: clamp(8px, 1.2vw, 14px);
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  gap: var(--g, 6px);              /* ירווח קטן בין המשקלים לטקסט; מצטמצם כשקצר */
}

@supports(padding: max(0px)){
  .tester{ width: calc(100vw - max(env(safe-area-inset-left), 8px) - max(env(safe-area-inset-right), 8px)); }
}

@media (max-width:700px){
  .site-header img{height:24px}
  .hero-wrap{padding-block:40px 56px}
  .tester{ width: calc(100vw - 12px); }
}

/* משקלים – ממורכזים */
.tt-weights{
  display:flex; justify-content:center; align-items:center;
  gap:10px; flex-wrap:wrap;
}
.tt-btn{
  font-family:"AlteZachen-HalfWide", system-ui, sans-serif;
  font-size: clamp(12px,1.25vw,16px);
  line-height:1;
  padding:8px 10px;
  border-radius:8px;
  background:#fff; color:#000;
  border:1px solid #000; cursor:pointer;
}
.tt-btn.active{ background:var(--red); color:#fff; border-color:var(--red) }

/* חלון הטקסט – רוחב קבוע 100%, גובה יישלט ב-JS (זורם מלמטה בלבד) */
.tt-window{
  position:relative;
  width:100%;                     /* לא זז לצדדים */
  border-radius:12px;
  display:flex; align-items:center; justify-content:center;
  overflow:hidden;                 /* בלי גלילה פנימית */
  transition:height .16s ease;     /* תנועה עדינה בגובה */
}

/* הטקסט */
.tt-canvas{
  --f: 180px;
  font-size: var(--f);
  line-height: 1;
  font-kerning: normal;
  font-feature-settings: "kern" 1, "liga" 1;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;

  font-family:"AlteZachen-Random", system-ui, sans-serif;
  color:#000; background:transparent;

  outline:none; border:none; caret-color:#000;

  white-space:nowrap;              /* שורה אחת */
  text-align:center; direction:rtl;

  display:block;                   /* לא inline-block → לא מרחיב קונטיינר */
  max-width:100%;                  /* לעולם לא יעבור את רוחב החלון */
  padding-inline: clamp(4px, 1vw, 8px);
  padding-bottom: 10px;            /* רזרבה לדסנדרים */
  transform: translateY(-2.5%);    /* הרמה אופטית קלה */
}
.tt-canvas:focus{ outline:none; }
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="site-header" aria-label="Header">
  <a class="logo-link" href="https://hafontia.com" target="_blank" rel="noopener">
    <img src="logoheader.webp" alt="הפונטיה — לינק" />
  </a>
</header>

<!-- ===== HERO ===== -->
<section class="hero-red" aria-label="Hero">
  <div class="hero-wrap">
    <picture>
      <source src="hero2.webp" type="image/webp" />
      <img class="hero-img" src="Asset 1.webp" alt="אלטע זאכן — ראש העמוד" />
    </picture>
  </div>
</section>

<!-- ===== MAIN ===== -->
<main class="white" aria-label="Main">

  <section class="tester-section">
    <div class="tester" data-default-font="AlteZachen-Random">
      <div class="tt-weights">
        <button class="tt-btn" data-font="AlteZachen-Normal">נורמל</button>
        <button class="tt-btn" data-font="AlteZachen-HalfWide">חצי־רחב</button>
        <button class="tt-btn" data-font="AlteZachen-Wide">רחב</button>
        <button class="tt-btn active" data-font="AlteZachen-Random">רנדום</button>
      </div>

      <div class="tt-window" id="ttWin">
        <div class="tt-canvas" id="tt" contenteditable="true" spellcheck="false">אלטע זאכן</div>
      </div>
    </div>
  </section>

</main>

<!-- ===== JS – Baseline = “אלטע זאכן”; גודל מקס למסך; חלון זורם אנכית בלבד ===== -->
<script>
(function(){
  const BASE_TEXT = 'אלטע זאכן';         // 9 תווים – זה הבייסליין המקסימלי לפי המסך
  const tester  = document.querySelector('.tester');
  if(!tester) return;

  const canvas  = document.getElementById('tt');
  const winBox  = document.getElementById('ttWin');
  const weights = tester.querySelectorAll('.tt-btn');
  const defFont = tester.getAttribute('data-default-font') || 'AlteZachen-Random';
  const mql     = window.matchMedia('(max-width:700px)');

  // תקרת פונט (בטיחות) – גבוהה בדסקטופ, נמוכה יותר במובייל
  const FONT_MAX_DESKTOP = 1400;
  const FONT_MAX_MOBILE  = 520;

  let baselineSize = null; // הגודל של “אלטע זאכן” לחלון הנוכחי (מקס למסך)

  // מודד נסתר לשימוש חוזר
  const meas = document.createElement('span');
  Object.assign(meas.style, {
    position:'absolute', visibility:'hidden', pointerEvents:'none',
    whiteSpace:'nowrap', lineHeight:'1'
  });
  document.body.appendChild(meas);

  // קובע משפחת גופן ומחשב baselineSize מחדש
  function setFontFamily(ff){
    canvas.style.fontFamily = `"${ff}", system-ui, sans-serif`;
    baselineSize = computeFit(BASE_TEXT, currentAvailW(), currentAvailH());
    fitAll(); // התאמה ראשונית
  }

  // רוחב/גובה זמינים בטסט־וינדו (פנימי, בלי לשנות רוחב הקונטיינר)
  function currentAvailW(){
    const cs = getComputedStyle(canvas);
    const padX = parseFloat(cs.paddingInlineStart) + parseFloat(cs.paddingInlineEnd);
    return Math.max(10, winBox.clientWidth - padX - 2);
  }
  function currentAvailH(){
    // גובה שהטקסט יכול לתפוס כרגע; בתחילה נקבע ע"י JS, בהמשך נעדכן
    // נשאיר guard קטן לדסנדרים
    return Math.max(10, winBox.clientHeight - 8);
  }

  // מחשב גודל פונט שמתאים גם לרוחב וגם לגובה (בינארי) + תקרת בטיחות
  function computeFit(text, availW, availH){
    const cs = getComputedStyle(canvas);
    meas.style.fontFamily    = cs.fontFamily;
    meas.style.letterSpacing = cs.letterSpacing;
    meas.textContent         = (text || '').trim() || BASE_TEXT;

    const FONT_MAX = mql.matches ? FONT_MAX_MOBILE : FONT_MAX_DESKTOP;

    let lo = 8, hi = FONT_MAX, best = 16;
    while (lo <= hi){
      const mid = Math.floor((lo + hi) / 2);
      meas.style.fontSize = mid + 'px';
      const r = meas.getBoundingClientRect();
      const fits = (r.width <= availW) && (r.height * 1.06 <= availH); // guard גובה
      if (fits){ best = mid; lo = mid + 1; } else { hi = mid - 1; }
    }
    return best;
  }

  // לוגיקה ראשית:
  // 1) גובה החלון (אנכי בלבד) — קצר: גבוה; ארוך: נמוך (טווח דחוס)
  // 2) גודל פונט — לא יעלה על baselineSize; ככל שמוסיפים טקסט → יורד
  function fitAll(){
    const txt = (canvas.textContent || '').trim() || BASE_TEXT;
    const len = [...txt].length;

    // טווחי גובה דחוסים
    const isMobile = mql.matches;
    const minVh = isMobile ? 20 : 16;
    const maxVh = isMobile ? 32 : 26;

    // בסיס: קצר (<=9) = קרוב ל-maxVh; ארוך → מצטמצם
    const shrink = Math.min(12, Math.max(0, (len - 9) * 0.5)); // קצב צמצום מהיר יותר
    let desiredVh = maxVh - shrink;
    if (desiredVh < minVh) desiredVh = minVh;

    // קבע גובה חלון לפני מדידת גודל הפונט (כדי שה-available H יהיה נכון)
    winBox.style.height = desiredVh + 'vh';

    // חשב גודל פונט שיתאים לרוחב/גובה הנוכחיים
    const sizeForText = computeFit(txt, currentAvailW(), currentAvailH());

    // הגבלת מקסימום: לא לגדול מעבר ל-baselineSize (אלטע זאכן ממלא מסך)
    const finalSize = Math.min(sizeForText, baselineSize || sizeForText);

    // החלת גודל
    canvas.style.setProperty('--f', finalSize + 'px');

    // ריווח קטן בין המשקלים לטקסט — כמעט נצמד כשקצר
    tester.style.setProperty('--g', (len <= 9 ? 4 : 8) + 'px');
  }

  // מאזינים
  weights.forEach(b=>{
    b.classList.toggle('active', b.dataset.font === defFont);
    b.addEventListener('click', ()=>{
      weights.forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      setFontFamily(b.dataset.font);
    });
  });

  setFontFamily(defFont);

  // כשמסך משתנה — לחשב מחדש את baselineSize למסך הנוכחי
  window.addEventListener('resize', ()=>{
    baselineSize = computeFit(BASE_TEXT, currentAvailW(), currentAvailH());
    fitAll();
  }, {passive:true});

  canvas.addEventListener('input', fitAll);
  canvas.addEventListener('focus', ()=>canvas.style.outline='none');
})();
</script>

</body>
</html>
